============================= test session starts =============================
platform win32 -- Python 3.14.3, pytest-9.0.2, pluggy-1.6.0 -- F:\Python Projects\accountinox\venv\Scripts\python.exe
cachedir: .pytest_cache
django: version: 6.0.2, settings: config.settings (from ini)
rootdir: F:\Python Projects\accountinox
configfile: pytest.ini
plugins: django-4.11.1
collecting ... collected 9 items

tests/test_smoke_routes.py::test_public_shop_blog_support_and_seo_routes_smoke Creating test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...
Operations to perform:
  Synchronize unmigrated apps: allauth, blog, google, humanize, messages, ratelimit, staticfiles
  Apply all migrations: account, accounts, admin, auth, contenttypes, core, sessions, shop, sites, socialaccount, support
Synchronizing apps without migrations:
  Creating tables...
    Creating table blog_post
    Creating table blog_postfaq
    Running deferred SQL...
Running migrations:
  Applying contenttypes.0001_initial... OK
  Applying auth.0001_initial... OK
  Applying account.0001_initial... OK
  Applying account.0002_email_max_length... OK
  Applying account.0003_alter_emailaddress_create_unique_verified_email... OK
  Applying account.0004_alter_emailaddress_drop_unique_email... OK
  Applying account.0005_emailaddress_idx_upper_email... OK
  Applying account.0006_emailaddress_lower... OK
  Applying account.0007_emailaddress_idx_email... OK
  Applying account.0008_emailaddress_unique_primary_email_fixup... OK
  Applying account.0009_emailaddress_unique_primary_email... OK
  Applying accounts.0001_initial... OK
  Applying accounts.0002_phoneotp_fields... OK
  Applying accounts.0003_populate_last_sent_default... OK
  Applying accounts.0004_phoneotp_schema_alignment... OK
  Applying accounts.0005_orderaddress... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying auth.0010_alter_group_name_max_length... OK
  Applying auth.0011_update_proxy_permissions... OK
  Applying auth.0012_alter_user_first_name_max_length... OK
  Applying core.0001_initial... OK
  Applying core.0002_alter_sitesettings_options_sitesettings_sms_enabled_and_more... OK
  Applying core.0003_sitesettings_brand_wordmark_fa... OK
  Applying sessions.0001_initial... OK
  Applying shop.0001_initial... OK
  Applying shop.0002_product_featured_image... OK
  Applying shop.0003_alter_product_featured_image... OK
  Applying shop.0004_order_customer_email_order_customer_name_and_more... OK
  Applying sites.0001_initial... OK
  Applying sites.0002_alter_domain_unique... OK
  Applying socialaccount.0001_initial... OK
  Applying socialaccount.0002_token_max_lengths... OK
  Applying socialaccount.0003_extra_data_default_dict... OK
  Applying socialaccount.0004_app_provider_id_settings... OK
  Applying socialaccount.0005_socialtoken_nullable_app... OK
  Applying socialaccount.0006_alter_socialaccount_extra_data... OK
  Applying support.0001_add_chatsession... OK
  Applying support.0002_supportpushsubscription... OK
  Applying support.0003_chatsession_user_phone_supportauditlog_and_more... OK
  Applying support.0004_alter_supportcontact_options_chatsession_assigned_to_and_more... OK
PASSED
tests/test_smoke_routes.py::test_support_rate_route_smoke_requires_owner_or_session_state PASSED
tests/test_smoke_routes.py::test_checkout_post_smoke_creates_transaction PASSED
tests/test_smoke_routes.py::test_account_dashboard_requires_login PASSED
tests/test_smoke_routes.py::test_order_detail_requires_owner PASSED
tests/test_smoke_routes.py::test_operator_routes_smoke PASSED
tests/test_smoke_routes.py::test_admin_routes_smoke FAILEDDestroying test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...


================================== FAILURES ===================================
___________________________ test_admin_routes_smoke ___________________________

self = <Variable: 'site_settings.site_name'>
context = [{'True': True, 'False': False, 'None': None}, {}, {}, {'site_title': '\u0645\u062f\u06cc\u0631\u06cc\u062a \u0648\u0628\\u200c\u06af\u0627\u0647 Django', 'site_header': '\u0645\u062f\u06cc...tes/site/', 'add_url': '/admin/sites/site/add/', 'view_only': False}]}], 'LANGUAGE_CODE': 'fa', 'LANGUAGE_BIDI': True}]

    def _resolve_lookup(self, context):
        """
        Perform resolution of a real variable (i.e. not a literal) against the
        given context.
    
        As indicated by the method's name, this method is an implementation
        detail and shouldn't be called by external code. Use Variable.resolve()
        instead.
        """
        current = context
        try:  # catch-all for silent variable failures
            for bit in self.lookups:
                try:  # dictionary lookup
                    # Only allow if the metaclass implements __getitem__. See
                    # https://docs.python.org/3/reference/datamodel.html#classgetitem-versus-getitem
                    if not hasattr(type(current), "__getitem__"):
>                       raise TypeError
E                       TypeError

venv\Lib\site-packages\django\template\base.py:964: TypeError

During handling of the above exception, another exception occurred:

self = <Variable: 'site_settings.site_name'>
context = [{'True': True, 'False': False, 'None': None}, {}, {}, {'site_title': '\u0645\u062f\u06cc\u0631\u06cc\u062a \u0648\u0628\\u200c\u06af\u0627\u0647 Django', 'site_header': '\u0645\u062f\u06cc...tes/site/', 'add_url': '/admin/sites/site/add/', 'view_only': False}]}], 'LANGUAGE_CODE': 'fa', 'LANGUAGE_BIDI': True}]

    def _resolve_lookup(self, context):
        """
        Perform resolution of a real variable (i.e. not a literal) against the
        given context.
    
        As indicated by the method's name, this method is an implementation
        detail and shouldn't be called by external code. Use Variable.resolve()
        instead.
        """
        current = context
        try:  # catch-all for silent variable failures
            for bit in self.lookups:
                try:  # dictionary lookup
                    # Only allow if the metaclass implements __getitem__. See
                    # https://docs.python.org/3/reference/datamodel.html#classgetitem-versus-getitem
                    if not hasattr(type(current), "__getitem__"):
                        raise TypeError
                    current = current[bit]
                    # ValueError/IndexError are for numpy.array lookup on
                    # numpy < 1.9 and 1.9+ respectively
                except (TypeError, AttributeError, KeyError, ValueError, IndexError):
                    try:  # attribute lookup
                        # Don't return class attributes if the class is the
                        # context:
                        if isinstance(current, BaseContext) and getattr(
                            type(current), bit
                        ):
                            raise AttributeError
>                       current = getattr(current, bit)
                                  ^^^^^^^^^^^^^^^^^^^^^
E                       AttributeError: 'NoneType' object has no attribute 'site_name'

venv\Lib\site-packages\django\template\base.py:976: AttributeError

During handling of the above exception, another exception occurred:

self = <Variable: 'site_settings.site_name'>
context = [{'True': True, 'False': False, 'None': None}, {}, {}, {'site_title': '\u0645\u062f\u06cc\u0631\u06cc\u062a \u0648\u0628\\u200c\u06af\u0627\u0647 Django', 'site_header': '\u0645\u062f\u06cc...tes/site/', 'add_url': '/admin/sites/site/add/', 'view_only': False}]}], 'LANGUAGE_CODE': 'fa', 'LANGUAGE_BIDI': True}]

    def _resolve_lookup(self, context):
        """
        Perform resolution of a real variable (i.e. not a literal) against the
        given context.
    
        As indicated by the method's name, this method is an implementation
        detail and shouldn't be called by external code. Use Variable.resolve()
        instead.
        """
        current = context
        try:  # catch-all for silent variable failures
            for bit in self.lookups:
                try:  # dictionary lookup
                    # Only allow if the metaclass implements __getitem__. See
                    # https://docs.python.org/3/reference/datamodel.html#classgetitem-versus-getitem
                    if not hasattr(type(current), "__getitem__"):
                        raise TypeError
                    current = current[bit]
                    # ValueError/IndexError are for numpy.array lookup on
                    # numpy < 1.9 and 1.9+ respectively
                except (TypeError, AttributeError, KeyError, ValueError, IndexError):
                    try:  # attribute lookup
                        # Don't return class attributes if the class is the
                        # context:
                        if isinstance(current, BaseContext) and getattr(
                            type(current), bit
                        ):
                            raise AttributeError
                        current = getattr(current, bit)
                    except (TypeError, AttributeError):
                        # Reraise if the exception was raised by a @property
                        if not isinstance(current, BaseContext) and bit in dir(current):
                            raise
                        try:  # list-index lookup
>                           current = current[int(bit)]
                                              ^^^^^^^^
E                           ValueError: invalid literal for int() with base 10: 'site_name'

venv\Lib\site-packages\django\template\base.py:982: ValueError

During handling of the above exception, another exception occurred:

client = <django.test.client.Client object at 0x000001739841A970>
support_staff = <User: support_staff>

    @pytest.mark.django_db
    def test_admin_routes_smoke(client, support_staff):
        client.force_login(support_staff)
        routes = [
            (reverse('admin:index'), 200),
            (reverse('admin:blog_post_changelist'), 200),
            (reverse('admin:shop_order_changelist'), 200),
            (reverse('admin:shop_transactionlog_changelist'), 200),
            (reverse('admin:support_chatsession_changelist'), 200),
            (reverse('admin:support_supportcontact_changelist'), 200),
            (reverse('admin:support_supportrating_changelist'), 200),
            (reverse('admin:accounts_phoneotp_changelist'), 200),
        ]
        for path, expected_status in routes:
>           response = client.get(path)
                       ^^^^^^^^^^^^^^^^

tests\test_smoke_routes.py:195: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
venv\Lib\site-packages\django\test\client.py:1124: in get
    response = super().get(
venv\Lib\site-packages\django\test\client.py:475: in get
    return self.generic(
venv\Lib\site-packages\django\test\client.py:671: in generic
    return self.request(**r)
           ^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\test\client.py:1087: in request
    self.check_exception(response)
venv\Lib\site-packages\django\test\client.py:802: in check_exception
    raise exc_value
venv\Lib\site-packages\django\core\handlers\exception.py:55: in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\core\handlers\base.py:221: in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\response.py:114: in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\response.py:92: in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\backends\django.py:107: in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:174: in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\loader_tags.py:160: in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\loader_tags.py:160: in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\test\utils.py:114: in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\defaulttags.py:333: in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\loader_tags.py:66: in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\loader_tags.py:66: in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1091: in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1052: in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:1150: in render
    output = self.filter_expression.resolve(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:809: in resolve
    arg_vals.append(arg.resolve(context))
                    ^^^^^^^^^^^^^^^^^^^^
venv\Lib\site-packages\django\template\base.py:928: in resolve
    value = self._resolve_lookup(context)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Variable: 'site_settings.site_name'>
context = [{'True': True, 'False': False, 'None': None}, {}, {}, {'site_title': '\u0645\u062f\u06cc\u0631\u06cc\u062a \u0648\u0628\\u200c\u06af\u0627\u0647 Django', 'site_header': '\u0645\u062f\u06cc...tes/site/', 'add_url': '/admin/sites/site/add/', 'view_only': False}]}], 'LANGUAGE_CODE': 'fa', 'LANGUAGE_BIDI': True}]

    def _resolve_lookup(self, context):
        """
        Perform resolution of a real variable (i.e. not a literal) against the
        given context.
    
        As indicated by the method's name, this method is an implementation
        detail and shouldn't be called by external code. Use Variable.resolve()
        instead.
        """
        current = context
        try:  # catch-all for silent variable failures
            for bit in self.lookups:
                try:  # dictionary lookup
                    # Only allow if the metaclass implements __getitem__. See
                    # https://docs.python.org/3/reference/datamodel.html#classgetitem-versus-getitem
                    if not hasattr(type(current), "__getitem__"):
                        raise TypeError
                    current = current[bit]
                    # ValueError/IndexError are for numpy.array lookup on
                    # numpy < 1.9 and 1.9+ respectively
                except (TypeError, AttributeError, KeyError, ValueError, IndexError):
                    try:  # attribute lookup
                        # Don't return class attributes if the class is the
                        # context:
                        if isinstance(current, BaseContext) and getattr(
                            type(current), bit
                        ):
                            raise AttributeError
                        current = getattr(current, bit)
                    except (TypeError, AttributeError):
                        # Reraise if the exception was raised by a @property
                        if not isinstance(current, BaseContext) and bit in dir(current):
                            raise
                        try:  # list-index lookup
                            current = current[int(bit)]
                        except (
                            IndexError,  # list index out of range
                            ValueError,  # invalid literal for int()
                            KeyError,  # current is a dict without `int(bit)` key
                            TypeError,
                        ):  # unsubscriptable object
>                           raise VariableDoesNotExist(
                                "Failed lookup for key [%s] in %r",
                                (bit, current),
                            )  # missing attribute
E                           django.template.base.VariableDoesNotExist: Failed lookup for key [site_name] in None

venv\Lib\site-packages\django\template\base.py:989: VariableDoesNotExist
=========================== short test summary info ===========================
FAILED tests/test_smoke_routes.py::test_admin_routes_smoke - django.template.base.VariableDoesNotExist: Failed lookup for key [site_name] in None
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
========================= 1 failed, 6 passed in 4.76s =========================
