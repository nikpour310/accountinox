{% load static %}
{% load seo_tags %}
<!-- Author: رامین جلیلی -->
<!doctype html>
<html lang="fa" dir="rtl" class="scroll-smooth">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ site_settings.brand_wordmark_fa|default:site_settings.site_name|default:'Accountinox' }}{% endblock %}</title>
    
    <!-- Meta/SEO -->
    <meta name="description" content="{% block meta_description %}{{ site_settings.site_description|default:'خرید امن اکانت و لایسنس دیجیتال با تحویل فوری' }}{% endblock %}">
    {% block meta_robots %}
    <meta name="robots" content="index,follow">
    {% endblock %}
    <meta name="theme-color" content="#14b8a6">
    
    <!-- Canonical -->
    {% canonical_url keep_page=True as canonical %}
    {% block canonical %}
    <link rel="canonical" href="{{ canonical }}">
    {% endblock %}

    <meta name="author" content="رامین جلیلی">
    
    <!-- Open Graph -->
    {% block og_tags %}
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="{{ site_settings.brand_wordmark_fa|default:site_settings.site_name|default:'Accountinox' }}">
    <meta property="og:title" content="{% block og_title %}{{ site_settings.site_name|default:'Accountinox' }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ site_settings.site_description|default:'خرید امن اکانت و لایسنس دیجیتال' }}{% endblock %}">
    <meta property="og:url" content="{{ canonical }}">
    <meta property="og:image" content="{% if site_settings.logo %}{{ site_settings.logo.url|abs_url }}{% else %}{{ '/static/img/og-image.jpg'|abs_url }}{% endif %}">
    {% endblock %}

    <!-- Fonts (Vazirmatn) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link href="{% static 'css/output.css' %}" rel="stylesheet">
    <link href="{% static 'css/mega-menu-override.css' %}" rel="stylesheet">

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>

    {% block extra_head %}{% endblock %}
    
    {% block schema_jsonld %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "{{ site_settings.site_name|default:'Accountinox' }}",
      "url": "{{ site_base_url }}"
    }
    </script>
    {% endblock %}
</head>
<body class="bg-gray-50/50 text-gray-800 antialiased font-sans flex flex-col min-h-screen">

    {% include "partials/navbar.html" %}

    <main class="flex-grow w-full">
        {% if messages %}
        <div class="fixed top-20 start-1/2 transform -translate-x-1/2 z-[60] w-full max-w-md px-4 pointer-events-none"{% if site_settings and site_settings.site_notice_enabled and site_settings.site_notice_text %} style="top: 7.5rem;"{% endif %} role="alert">
            {% for message in messages %}
            <div class="pointer-events-auto mb-3 flex items-center w-full p-4 rounded-xl shadow-soft-lg text-sm font-medium backdrop-blur-sm
                {% if message.tags == 'debug' %}bg-gray-600 text-white{% elif message.tags == 'info' %}bg-sky-500 text-white{% elif message.tags == 'success' %}bg-emerald-500 text-white{% elif message.tags == 'warning' %}bg-amber-500 text-white{% elif message.tags == 'error' %}bg-red-500 text-white{% endif %}"
                x-data="{ show: true }" x-show="show"
                x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 -translate-y-2 scale-95"
                x-transition:enter-end="opacity-100 translate-y-0 scale-100"
                x-transition:leave="transition ease-in duration-200"
                x-transition:leave-start="opacity-100 translate-y-0"
                x-transition:leave-end="opacity-0 -translate-y-2"
                x-init="setTimeout(() => show = false, 5000)">
                <div class="flex-shrink-0 me-3">
                    {% if message.tags == 'success' %}
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    {% elif message.tags == 'error' %}
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    {% else %}
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    {% endif %}
                </div>
                <div class="flex-grow">{{ message }}</div>
                <button @click="show = false" class="ms-3 w-5 h-5 opacity-70 hover:opacity-100 transition-opacity">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </main>

    {% include "partials/footer.html" %}

    <!-- Scroll Reveal Observer -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });
        document.querySelectorAll('.reveal, .stagger-children').forEach(el => observer.observe(el));
    });
    </script>

    {% block extra_scripts %}{% endblock %}
</body>
</html>
